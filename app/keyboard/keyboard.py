import logging

from app.func.user.functions import *
from app.func.admin.functions import *
from telegram.ext import CallbackQueryHandler
from app.func.admin.functions import personal_menu
from app.func.admin.adv import *



# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
async def handle_message(update: Update, context: CallbackContext):
    text = update.message.text
    state = context.user_data.get('state')

    if text == "–°–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–πüìû":
        await callback(update, context)
    elif text == "–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è‚ùì":
        await start(update, context)
    elif text == "–ê–Ω–∞–ª–∏–∑ —Ç–æ–≤–∞—Ä–∞üîé":
        await request_product_name(update, context)
    elif state == 'AWAITING_PRODUCT_NAME':
        await analyze_product(update, context)
    elif text == "–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤üìí":
        await history_requests(update, context)
    elif text == "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –º–µ–Ω—é‚Äçü§ì":
        await personal_menu(update, context)
    elif text == "–†–µ–∫–ª–∞–º–∞üíµ":
        await start_adv(update, context)


# –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫ –ê–Ω–∞–ª–∏–∑ –∏ –í–µ—Ä–Ω—É—Ç—å—Å—è
async def handle_callback_query(update: Update, context: CallbackContext):
    query = update.callback_query
    await query.answer()
    data = query.data

    if data == "1":
        await request_product_name(update, context)
    elif data == "2":
        await start(update, context)


callback_query_handler = CallbackQueryHandler(handle_callback_query)
